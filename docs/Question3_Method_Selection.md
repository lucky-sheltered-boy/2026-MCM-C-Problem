# 第三题：因素影响分析 - 方法选择与实验报告

## 1. 研究目标

分析影响《与星共舞》(DWTS) 中**评委评分**和**粉丝投票**的因素差异。

**核心问题**：职业舞伴(Partner)、名人行业(Industry)、年龄(Age)、赛季(Season)等因素对评委评分和粉丝投票的影响方式是否相同？

## 2. 数据准备

### 2.1 数据来源

| 数据集 | 样本量 | 说明 |
|--------|--------|------|
| `engineered_data.csv` | 421 位名人 | 原始特征数据 |
| `mcmc_smooth_results.csv` | 368 周 | MCMC估计的粉丝投票（含决赛周） |

### 2.2 特征工程

#### 目标变量
- **评委评分** (`avg_judge_score`)：名人在赛季中的平均周得分
- **粉丝投票** (`avg_fan_vote`)：MCMC估计的平均粉丝投票份额

#### 特征变量
| 特征 | 类型 | 说明 |
|------|------|------|
| `celebrity_age_during_season` | 数值 | 参赛时年龄 |
| `season` | 数值 | 赛季编号 (1-34) |
| `partner_hist_score_mean_loo` | 数值 | Partner历史平均得分（留一法） |
| `partner_hist_placement_loo` | 数值 | Partner历史平均名次（留一法） |
| `partner_n_celebs_loo` | 数值 | Partner带过的其他名人数量 |
| `celebrity_industry` | 分类 | 名人所属行业（独热编码，26个类别） |

### 2.3 数据泄露问题与修正

**问题发现**：初始版本直接使用Partner的整体统计数据（包含当前名人），导致数据泄露。

例如：某Partner只出场1次，其`partner_hist_score_mean`就等于该名人自己的得分，相当于用目标变量预测目标变量。

**修正方案**：采用**留一法 (Leave-One-Out)**
- 计算每位名人的Partner统计时，排除该名人自己
- 对于只出场1次的Partner（无法计算留一统计），使用全局均值填充
- 共有20位名人使用了全局均值填充

## 3. 模型选择实验

### 3.1 候选模型

我们评估了两种回归模型：

| 模型 | 优势 | 劣势 |
|------|------|------|
| **Ridge回归** | 系数可解释、方向明确、抗共线性 | 只能捕捉线性关系 |
| **随机森林** | 可捕捉非线性、特征交互 | 易过拟合、不可解释方向 |

### 3.2 评估指标

采用**5折交叉验证 R²** 作为主要评估指标，避免过拟合导致的虚高性能。

### 3.3 实验结果

#### 评委评分预测

| 模型 | R² (训练集) | R² (5折CV) | 判断 |
|------|-------------|------------|------|
| Ridge回归 | 0.3683 | **0.3065 ± 0.09** | ✅ 泛化较好 |
| 随机森林 | 0.8902 | 0.2074 ± 0.08 | ⚠️ 过拟合 |

#### 粉丝投票预测

| 模型 | R² (训练集) | R² (5折CV) | 判断 |
|------|-------------|------------|------|
| Ridge回归 | 0.1169 | **-0.0375 ± 0.05** | 无法预测 |
| 随机森林 | 0.7510 | -0.0114 ± 0.05 | ❌ 严重过拟合 |

### 3.4 模型选择结论

**选择 Ridge 线性回归**，理由如下：

1. **泛化能力**
   - 随机森林训练R²=0.89，但CV仅0.21，过拟合严重
   - Ridge回归训练/CV差距更小，泛化更稳定

2. **可解释性**
   - Ridge系数有正负方向，可直接解读因素影响方向
   - 随机森林只有重要性，无法判断正向还是负向影响

3. **适用性**
   - 粉丝投票本质不可预测（R²≈0），复杂模型无意义
   - 简单模型足以揭示"不可预测"这一核心结论

## 4. 最终模型结果

### 4.1 模型配置

```python
from sklearn.linear_model import Ridge
from sklearn.preprocessing import StandardScaler

model = Ridge(alpha=1.0)  # L2正则化
scaler = StandardScaler()  # 特征标准化
```

### 4.2 核心发现

#### 模型性能对比

| 目标变量 | R² (5折CV) | 解释 |
|----------|------------|------|
| 评委评分 | **0.3065** | 可被观测因素部分解释 |
| 粉丝投票 | **-0.0375** | 完全无法预测 |

#### 标准化回归系数对比

| 特征 | 评委评分系数 | 粉丝投票系数 | 解读 |
|------|-------------|-------------|------|
| **年龄** | **-0.62** | -0.01 | 评委偏好年轻选手，粉丝不偏好 |
| **赛季** | +0.39 | -0.01 | 评委近年评分更宽松 |
| **Partner得分** | **+0.29** | -0.003 | 评委认可优秀Partner，粉丝不在意 |
| **Partner经验** | +0.17 | +0.002 | 评委偏好资深Partner |
| **Partner名次** | +0.01 | -0.003 | 影响较弱 |

#### 行业效应（完整分析）

**评委评分** - 标准化系数按影响排序:

| 行业 | 系数 | 样本量 | 解读 |
|------|------|--------|------|
| Social Media Personality | **+0.17** | 8 | 最受益 |
| Actor/Actress | **+0.08** | 128 | 正面影响（样本充足） |
| Conservationist | +0.08 | 1 | ⚠️ 样本过少 |
| Singer/Rapper | **+0.07** | 61 | 正面影响 |
| Athlete | **+0.05** | 95 | 轻微正面（样本充足） |
| News Anchor | ≈0 | 3 | 无影响 |
| TV Personality | **-0.05** | 67 | 轻微负面（样本充足） |
| Model | **-0.09** | 17 | 负面影响 |
| Radio Personality | -0.09 | 4 | 负面影响 |
| Magician | -0.09 | 1 | ⚠️ 样本过少 |
| Entrepreneur | **-0.13** | 4 | 负面影响 |
| Politician | **-0.14** | 3 | 负面影响 |
| Astronaut | -0.15 | 1 | ⚠️ 样本过少 |
| Journalist | -0.15 | 1 | ⚠️ 样本过少 |
| Comedian | **-0.20** | 12 | 最受损 |

**关键发现**：
- 演艺相关行业（演员、歌手）表现较好
- 非表演类行业（喜剧演员、政客、企业家）表现较差
- 社交媒体红人系数最高，但样本量仅8人需谨慎解读
- 样本量n=1的行业结果不可靠

**粉丝投票** - 行业几乎无影响:
- 所有行业系数绝对值 < 0.01

### 4.3 结论

1. **评委评分可预测 (R²=30.7%)**
   - 主要驱动因素：年龄 > Partner历史表现 > 赛季
   - 评委关注"舞蹈能力相关因素"
   - 演艺背景有正面效应，喜剧/政治背景有负面效应

2. **粉丝投票不可预测 (R²≈-4%)**
   - 所有观测因素都无法解释粉丝投票
   - 粉丝投票由"难以量化的个人魅力"驱动

3. **核心差异**
   - Partner效应：评委高度认可（+0.29），粉丝完全忽视（≈0）
   - 年龄效应：评委惩罚高龄（-0.62），粉丝无差异（≈0）
   - 行业效应：评委有系统性偏好（喜剧演员-0.20，演员+0.08），粉丝无差异

## 5. 方法论总结

### 5.1 技术路线

```
原始数据 → 留一法特征工程 → 模型选择实验 → Ridge回归分析 → 对比结论
```

### 5.2 关键方法论决策

| 决策点 | 选择 | 理由 |
|--------|------|------|
| Partner统计 | 留一法 | 避免数据泄露 |
| 行业编码 | 独热编码 | 无序分类变量 |
| 特征缩放 | StandardScaler | 使系数可比较 |
| 正则化 | Ridge (L2) | 抗共线性 |
| 模型选择 | Ridge vs 随机森林 | 基于CV性能 |
| 评估指标 | 5折CV R² | 避免过拟合 |

### 5.3 局限性

1. **粉丝投票为估计值**：来自MCMC模型，非真实观测
2. **行业分类不均衡**：部分行业样本量<5
3. **时序未建模**：未考虑赛季内的动态变化

---

*文档版本：v2.0*  
*更新日期：2026年2月1日*  
*分析脚本：`analysis_q3_factors.py`*  
*数据变更：`avg_weekly_score` → `avg_judge_score`*
